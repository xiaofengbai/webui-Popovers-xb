(function(b,a,c){(function(d){if(typeof define==="function"&&define.amd){define(["jquery"],d)}else{if(typeof exports==="object"){module.exports=d(require("jquery"))}else{d(b.jQuery)}}}(function(g){var d="webuiPopover";var h="webui-popover";var f="webui.popover";var j={placement:"auto",container:null,width:"auto",height:"auto",trigger:"click",style:"",selector:false,delay:{show:null,hide:300},async:{type:"GET",before:null,success:null,error:null},cache:true,multi:false,arrow:true,title:"",content:"",closeable:false,padding:true,url:"",type:"html",direction:"",animation:null,template:'<div class="webui-popover">'+'<div class="webui-arrow"></div>'+'<div class="webui-popover-inner">'+'<a href="#" class="close"></a>'+'<h3 class="webui-popover-title"></h3>'+'<div class="webui-popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div>'+"</div>"+"</div>",backdrop:false,dismissible:true,onShow:null,onHide:null,abortXHR:true,autoHide:false,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""},hideEmpty:false};var k=h+"-rtl";var q=[];var r=g('<div class="webui-popover-backdrop"></div>');var u=0;var s=false;var i=-2000;var v=g(a);var t=function(x,y){return isNaN(x)?(y||0):Number(x)};var o=function(x){return x.data("plugin_"+d)};var e=function(){var x=null;for(var y=0;y<q.length;y++){x=o(q[y]);if(x){x.hide(true)}}v.trigger("hiddenAll."+f)};var w=function(z){var x=null;for(var y=0;y<q.length;y++){x=o(q[y]);if(x&&x.id!==z.id){x.hide(true)}}v.trigger("hiddenAll."+f)};var p=("ontouchstart" in a.documentElement)&&(/Mobi/.test(navigator.userAgent));var n=function(y){var x={x:0,y:0};if(y.type==="touchstart"||y.type==="touchmove"||y.type==="touchend"||y.type==="touchcancel"){var z=y.originalEvent.touches[0]||y.originalEvent.changedTouches[0];x.x=z.pageX;x.y=z.pageY}else{if(y.type==="mousedown"||y.type==="mouseup"||y.type==="click"){x.x=y.pageX;x.y=y.pageY}}return x};function m(y,x){this.$element=g(y);if(x){if(g.type(x.delay)==="string"||g.type(x.delay)==="number"){x.delay={show:x.delay,hide:x.delay}}}this.options=g.extend({},j,x);this._defaults=j;this._name=d;this._targetclick=false;this.init();q.push(this.$element);return this}m.prototype={init:function(){if(this.$element[0] instanceof a.constructor&&!this.options.selector){throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!")}if(this.getTrigger()!=="manual"){if(this.getTrigger()==="click"||p){this.$element.off("click touchend",this.options.selector).on("click touchend",this.options.selector,g.proxy(this.toggle,this))}else{if(this.getTrigger()==="hover"){this.$element.off("mouseenter mouseleave click",this.options.selector).on("mouseenter",this.options.selector,g.proxy(this.mouseenterHandler,this)).on("mouseleave",this.options.selector,g.proxy(this.mouseleaveHandler,this))}}}this._poped=false;this._inited=true;this._opened=false;this._idSeed=u;this.id=d+this._idSeed;this.options.container=g(this.options.container||a.body).first();if(this.options.backdrop){r.appendTo(this.options.container).hide()}u++;if(this.getTrigger()==="sticky"){this.show()}if(this.options.selector){this._options=g.extend({},this.options,{selector:""})}},destroy:function(){var x=-1;for(var y=0;y<q.length;y++){if(q[y]===this.$element){x=y;break}}q.splice(x,1);this.hide();this.$element.data("plugin_"+d,null);if(this.getTrigger()==="click"){this.$element.off("click")}else{if(this.getTrigger()==="hover"){this.$element.off("mouseenter mouseleave")}}if(this.$target){this.$target.remove()}},getDelegateOptions:function(){var x={};this._options&&g.each(this._options,function(y,z){if(j[y]!==z){x[y]=z}});return x},hide:function(z,y){if(!z&&this.getTrigger()==="sticky"){return}if(!this._opened){return}if(y){y.preventDefault();y.stopPropagation()}if(this.xhr&&this.options.abortXHR===true){this.xhr.abort();this.xhr=null}var A=g.Event("hide."+f);this.$element.trigger(A,[this.$target]);if(this.$target){this.$target.removeClass("in").addClass(this.getHideAnimation());var x=this;setTimeout(function(){x.$target.hide();if(!x.getCache()){x.$target.remove()}},x.getHideDelay())}if(this.options.backdrop){r.hide()}this._opened=false;this.$element.trigger("hidden."+f,[this.$target]);if(this.options.onHide){this.options.onHide(this.$target)}},resetAutoHide:function(){var y=this;var x=y.getAutoHide();if(x){if(y.autoHideHandler){clearTimeout(y.autoHideHandler)}y.autoHideHandler=setTimeout(function(){y.hide()},x)}},delegate:function(y){var x=g(y).data("plugin_"+d);if(!x){x=new m(y,this.getDelegateOptions());g(y).data("plugin_"+d,x)}return x},toggle:function(y){var x=this;if(y){y.preventDefault();y.stopPropagation();if(this.options.selector){x=this.delegate(y.currentTarget)}}x[x.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){e()},hideOthers:function(){w(this)},show:function(){if(this._opened){return}var x=this.getTarget().removeClass().addClass(h).addClass(this._customTargetClass);
if(!this.options.multi){this.hideOthers()}if(!this.getCache()||!this._poped||this.content===""){this.content="";this.setTitle(this.getTitle());if(!this.options.closeable){x.find(".close").off("click").remove()}if(!this.isAsync()){this.setContent(this.getContent())}else{this.setContentASync(this.options.content)}if(this.canEmptyHide()&&this.content===""){return}x.show()}this.displayContent();if(this.options.onShow){this.options.onShow(x)}this.bindBodyEvents();if(this.options.backdrop){r.show()}this._opened=true;this.resetAutoHide()},displayContent:function(){var z=this.getElementPosition(),x=this.getTarget().removeClass().addClass(h).addClass(this._customTargetClass),J=this.getContentElement(),H=x[0].offsetWidth,E=x[0].offsetHeight,B="bottom",F=g.Event("show."+f);if(this.canEmptyHide()){var G=J.children().html();if(G!==null&&G.trim().length===0){return}}this.$element.trigger(F,[x]);var y=this.$element.data("width")||this.options.width;if(y===""){y=this._defaults.width}if(y!=="auto"){x.width(y)}var K=this.$element.data("height")||this.options.height;if(K===""){K=this._defaults.height}if(K!=="auto"){J.height(K)}if(this.options.style){this.$target.addClass(h+"-"+this.options.style)}if(this.options.direction==="rtl"&&!J.hasClass(k)){J.addClass(k)}if(!this.options.arrow){x.find(".webui-arrow").remove()}x.detach().css({top:i,left:i,display:"block"});if(this.getAnimation()){x.addClass(this.getAnimation())}x.appendTo(this.options.container);B=this.getPlacement(z);this.$element.trigger("added."+f);this.initTargetEvents();if(!this.options.padding){if(this.options.height!=="auto"){J.css("height",J.outerHeight())}this.$target.addClass("webui-no-padding")}H=x[0].offsetWidth;E=x[0].offsetHeight;var A=this.getTargetPositin(z,B,H,E);this.$target.css(A.position).addClass(B).addClass("in");if(this.options.type==="iframe"){var L=x.find("iframe");var D=x.width();var C=L.parent().height();if(this.options.iframeOptions.width!==""&&this.options.iframeOptions.width!=="auto"){D=this.options.iframeOptions.width}if(this.options.iframeOptions.height!==""&&this.options.iframeOptions.height!=="auto"){C=this.options.iframeOptions.height}L.width(D).height(C)}if(!this.options.arrow){this.$target.css({"margin":0})}if(this.options.arrow){var I=this.$target.find(".webui-arrow");I.removeAttr("style");if(B==="left"||B==="right"){I.css({top:this.$target.height()/2})}else{if(B==="top"||B==="bottom"){I.css({left:this.$target.width()/2})}}if(A.arrowOffset){if(A.arrowOffset.left===-1||A.arrowOffset.top===-1){I.hide()}else{I.css(A.arrowOffset)}}}this._poped=true;this.$element.trigger("shown."+f,[this.$target])},isTargetLoaded:function(){return this.getTarget().find("i.glyphicon-refresh").length===0},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var x=d+this._idSeed;this.$target=g(this.options.template).attr("id",x);this._customTargetClass=this.$target.attr("class")!==h?this.$target.attr("class"):null;this.getTriggerElement().attr("data-target",x)}if(!this.$target.data("trigger-element")){this.$target.data("trigger-element",this.getTriggerElement())}return this.$target},removeTarget:function(){this.$target.remove();this.$target=null;this.$contentElement=null},getTitleElement:function(){return this.getTarget().find("."+h+"-title")},getContentElement:function(){if(!this.$contentElement){this.$contentElement=this.getTarget().find("."+h+"-content")}return this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title||this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){return t(this.$element.attr("data-offset-top"))||this.options.offsetTop},getOffsetLeft:function(){return t(this.$element.attr("data-offset-left"))||this.options.offsetLeft},getCache:function(){var x=this.$element.attr("data-cache");if(typeof(x)!=="undefined"){switch(x.toLowerCase()){case"true":case"yes":case"1":return true;case"false":case"no":case"0":return false}}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var x=this.$element.attr("data-delay-show");if(typeof(x)!=="undefined"){return x}return this.options.delay.show===0?0:this.options.delay.show||100},getHideDelay:function(){var x=this.$element.attr("data-delay-hide");if(typeof(x)!=="undefined"){return x}return this.options.delay.hide===0?0:this.options.delay.hide||100},getAnimation:function(){var x=this.$element.attr("data-animation");return x||this.options.animation},getHideAnimation:function(){var x=this.getAnimation();return x?x+"-out":"out"},setTitle:function(x){var y=this.getTitleElement();if(x){if(this.options.direction==="rtl"&&!y.hasClass(k)){y.addClass(k)}y.html(x)}else{y.remove()}},hasContent:function(){return this.getContent()},canEmptyHide:function(){return this.options.hideEmpty&&this.options.type==="html"
},getIframe:function(){var y=g("<iframe></iframe>").attr("src",this.getUrl());var x=this;g.each(this._defaults.iframeOptions,function(z){if(typeof x.options.iframeOptions[z]!=="undefined"){y.attr(z,x.options.iframeOptions[z])}});return y},getContent:function(){if(this.getUrl()){switch(this.options.type){case"iframe":this.content=this.getIframe();break;case"html":try{this.content=g(this.getUrl());if(!this.content.is(":visible")){this.content.show()}}catch(y){throw new Error("Unable to get popover content. Invalid selector specified.")}break}}else{if(!this.content){var z="";if(g.isFunction(this.options.content)){z=this.options.content.apply(this.$element[0],[this])}else{z=this.options.content}this.content=this.$element.attr("data-content")||z;if(!this.content){var x=this.$element.next();if(x&&x.hasClass(h+"-content")){this.content=x}}}}return this.content},setContent:function(z){var x=this.getTarget();var y=this.getContentElement();if(typeof z==="string"){y.html(z)}else{if(z instanceof g){y.html("");if(!this.options.cache){z.clone(true,true).removeClass(h+"-content").appendTo(y)}else{z.removeClass(h+"-content").appendTo(y)}}}this.$target=x},isAsync:function(){return this.options.type==="async"},setContentASync:function(y){var x=this;if(this.xhr){return}this.xhr=g.ajax({url:this.getUrl(),type:this.options.async.type,cache:this.getCache(),beforeSend:function(z){if(x.options.async.before){x.options.async.before(x,z)}},success:function(A){x.bindBodyEvents();if(y&&g.isFunction(y)){x.content=y.apply(x.$element[0],[A])}else{x.content=A}x.setContent(x.content);var z=x.getContentElement();z.removeAttr("style");x.displayContent();if(x.options.async.success){x.options.async.success(x,A)}},complete:function(){x.xhr=null},error:function(A,z){if(x.options.async.error){x.options.async.error(x,A,z)}}})},bindBodyEvents:function(){if(s){return}if(this.options.dismissible&&this.getTrigger()==="click"){v.off("keyup.webui-popover").on("keyup.webui-popover",g.proxy(this.escapeHandler,this));v.off("click.webui-popover touchend.webui-popover").on("click.webui-popover touchend.webui-popover",g.proxy(this.bodyClickHandler,this))}else{if(this.getTrigger()==="hover"){v.off("touchend.webui-popover").on("touchend.webui-popover",g.proxy(this.bodyClickHandler,this))}}},mouseenterHandler:function(y){var x=this;if(y&&this.options.selector){x=this.delegate(y.currentTarget)}if(x._timeout){clearTimeout(x._timeout)}x._enterTimeout=setTimeout(function(){if(!x.getTarget().is(":visible")){x.show()}},this.getDelayShow())},mouseleaveHandler:function(){var x=this;clearTimeout(x._enterTimeout);x._timeout=setTimeout(function(){x.hide()},this.getHideDelay())},escapeHandler:function(x){if(x.keyCode===27){this.hideAll()}},bodyClickHandler:function(C){s=true;var D=true;if(C.target.nodeName.toLowerCase()=="select"){D=false}for(var z=0;z<q.length;z++){var F=o(q[z]);if(F&&F._opened){var y=F.getTarget().offset();var G=y.left;var B=y.top;var E=y.left+F.getTarget().width();var A=y.top+F.getTarget().height();var H=n(C);var x=H.x>=G&&H.x<=E&&H.y>=B&&H.y<=A;if(x){D=false;break}}}if(D){e()}},initTargetEvents:function(){if(this.getTrigger()==="hover"){this.$target.off("mouseenter mouseleave").on("mouseenter",g.proxy(this.mouseenterHandler,this)).on("mouseleave",g.proxy(this.mouseleaveHandler,this))}this.$target.find(".close").off("click").on("click",g.proxy(this.hide,this,true))},getPlacement:function(H){var E,y=this.options.container,I=y.innerWidth(),F=y.innerHeight(),A=y.scrollTop(),B=y.scrollLeft(),D=Math.max(0,H.left-B),C=Math.max(0,H.top-A);if(typeof(this.options.placement)==="function"){E=this.options.placement.call(this,this.getTarget()[0],this.$element[0])}else{E=this.$element.data("placement")||this.options.placement}var G=E==="horizontal";var x=E==="vertical";var z=E==="auto"||G||x;if(z){if(D<I/3){if(C<F/3){E=G?"right-bottom":"bottom-right"}else{if(C<F*2/3){if(x){E=C<=F/2?"bottom-right":"top-right"}else{E="right"}}else{E=G?"right-top":"top-right"}}}else{if(D<I*2/3){if(C<F/3){if(G){E=D<=I/2?"right-bottom":"left-bottom"}else{E="bottom"}}else{if(C<F*2/3){if(G){E=D<=I/2?"right":"left"}else{E=C<=F/2?"bottom":"top"}}else{if(G){E=D<=I/2?"right-top":"left-top"}else{E="top"}}}}else{if(C<F/3){E=G?"left-bottom":"bottom-left"}else{if(C<F*2/3){if(x){E=C<=F/2?"bottom-left":"top-left"}else{E="left"}}else{E=G?"left-top":"top-left"}}}}}else{if(E==="auto-top"){if(D<I/3){E="top-right"}else{if(D<I*2/3){E="top"}else{E="top-left"}}}else{if(E==="auto-bottom"){if(D<I/3){E="bottom-right"}else{if(D<I*2/3){E="bottom"}else{E="bottom-left"}}}else{if(E==="auto-left"){if(C<F/3){E="left-top"}else{if(C<F*2/3){E="left"}else{E="left-bottom"}}}else{if(E==="auto-right"){if(C<F/3){E="right-bottom"}else{if(C<F*2/3){E="right"}else{E="right-top"}}}}}}}return E},getElementPosition:function(){var A=this.$element[0].getBoundingClientRect();var z=this.options.container;var y=z.css("position");if(z.is(a.body)||y==="static"){return g.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth||A.width,height:this.$element[0].offsetHeight||A.height})
}else{if(y==="fixed"){var x=z[0].getBoundingClientRect();return{top:A.top-x.top+z.scrollTop(),left:A.left-x.left+z.scrollLeft(),width:A.width,height:A.height}}else{if(y==="relative"){return{top:this.$element.offset().top-z.offset().top,left:this.$element.offset().left-z.offset().left,width:this.$element[0].offsetWidth||A.width,height:this.$element[0].offsetHeight||A.height}}}}},getTargetPositin:function(Q,L,B,C){var D=Q,J=this.options.container,z=this.$element.outerWidth(),G=this.$element.outerHeight(),y=a.documentElement.scrollTop+J.scrollTop(),P=a.documentElement.scrollLeft+J.scrollLeft(),S={},N=null,M=this.options.arrow?20:0,K=10,A=z<M+K?M:0,I=G<M+K?M:0,T=0,E=a.documentElement.clientHeight+y,x=a.documentElement.clientWidth+P;var O=D.left+D.width/2-A>0;var R=D.left+D.width/2+A<x;var F=D.top+D.height/2-I>0;var H=D.top+D.height/2+I<E;switch(L){case"bottom":S={top:D.top+D.height,left:D.left+D.width/2-B/2};break;case"top":S={top:D.top-C,left:D.left+D.width/2-B/2};break;case"left":S={top:D.top+D.height/2-C/2,left:D.left-B};break;case"right":S={top:D.top+D.height/2-C/2,left:D.left+D.width};break;case"top-right":S={top:D.top-C,left:O?D.left-A:K};N={left:O?Math.min(z,B)/2+A:i};break;case"top-left":T=R?A:-K;S={top:D.top-C,left:D.left-B+D.width+T};N={left:R?B-Math.min(z,B)/2-A:i};break;case"bottom-right":S={top:D.top+D.height,left:O?D.left-A:K};N={left:O?Math.min(z,B)/2+A:i};break;case"bottom-left":T=R?A:-K;S={top:D.top+D.height,left:D.left-B+D.width+T};N={left:R?B-Math.min(z,B)/2-A:i};break;case"right-top":T=H?I:-K;S={top:D.top-C+D.height+T,left:D.left+D.width};N={top:H?C-Math.min(G,C)/2-I:i};break;case"right-bottom":S={top:F?D.top-I:K,left:D.left+D.width};N={top:F?Math.min(G,C)/2+I:i};break;case"left-top":T=H?I:-K;S={top:D.top-C+D.height+T,left:D.left-B};N={top:H?C-Math.min(G,C)/2-I:i};break;case"left-bottom":S={top:F?D.top-I:K,left:D.left-B};N={top:F?Math.min(G,C)/2+I:i};break}S.top+=this.getOffsetTop();S.left+=this.getOffsetLeft();return{position:S,arrowOffset:N}}};g.fn[d]=function(z,y){var A=[];var x=this.each(function(){var B=g.data(this,"plugin_"+d);if(!B){if(!z){B=new m(this,null)}else{if(typeof z==="string"){if(z!=="destroy"){if(!y){B=new m(this,null);A.push(B[z]())}}}else{if(typeof z==="object"){B=new m(this,z)}}}g.data(this,"plugin_"+d,B)}else{if(z==="destroy"){B.destroy()}else{if(typeof z==="string"){A.push(B[z]())}}}});return(A.length)?A:x};var l=(function(){var y=function(){e()};var B=function(D,E){E=E||{};g(D).webuiPopover(E)};var z=function(D){var E=true;g(D).each(function(F){E=E&&g(F).data("plugin_"+d)!==c});return E};var C=function(D,E){if(E){g(D).webuiPopover(E).webuiPopover("show")}else{g(D).webuiPopover("show")}};var x=function(D){g(D).webuiPopover("hide")};var A=function(D,G){var F=g(D).data("plugin_"+d);if(F){var E=F.getCache();F.options.cache=false;F.options.content=G;if(F._opened){F._opened=false;F.show()}else{if(F.isAsync()){F.setContentASync(G)}else{F.setContent(G)}}F.options.cache=E}};return{show:C,hide:x,create:B,isCreated:z,hideAll:y,updateContent:A}})();b.WebuiPopovers=l}))})(window,document);